define("superapi/api",["exports"],function(a){"use strict";function b(a){this.api=Object.create(null),this.configure(a)}var c=function(a){return function(b){b=b||{};var c=b.data||{},d=b.params||{},e=b.query||{},f=b.callback||null,g=b.edit||null,h=this.request(a,c,d,e);g&&"function"==typeof g&&g(h);var i=this._applyMiddlewares(h,this.service(a));return new Promise(function(a,b){var c=function(a){b(a),i(a)},d=function(b){a(b),i(null,b)};h.on("error",c),h.on("abort",function(){var a=new Error("Request has been aborted");a.aborted=!0,c(a)}),h.end(f||function(a,b){var e=a||b.error;if(e)return c(b,e);d(b)})})}};b.prototype={paramsPattern:/:(\w+)/g,configure:function(a){if(this.config=a||{},a)for(var b in a.services)Object.prototype.hasOwnProperty(this,b)||(this.api[b]=c(b).bind(this))},service:function(a){return this.config.services[a]},url:function(a){var b=this.config.baseUrl,c=this.service(a);if(c){var d;if("string"==typeof c&&(d=c),"object"==typeof c&&void 0!==c.path&&(d=c.path),!d)throw new Error("path is not defined for route $"+a);d.match(/^https?:\/\//)?b=d:b+="/"===d[0]?d:"/"+d}return b},replaceUrl:function(a,b){var c=a.match(this.paramsPattern);if(!c||!c.length)return a;for(var d=0,e=c.length;d<e;d+=1){var f=c[d],g=f.substring(1);b[g]&&(a=a.replace(f,b[g]))}return a},buildUrlQuery:function(a){if(!a)return"";var b;if("string"==typeof a)b=a;else{var c=[];for(var d in a)c.push(d+"="+a[d]);b=c.join("&")}return b?"?"+b:""},buildUrl:function(a,b,c){var d=this.url(a);return b&&(d=this.replaceUrl(d,b)),c&&(d+=this.buildUrlQuery(c)),d},request:function(a,b,c,d){var e=this.service(a),f=("string"==typeof e?"get":e.method||"get").toLowerCase(),g={options:e.options,headers:e.headers};return this.buildRequest(f,this.buildUrl(a,c,d),b,g)},buildRequest:function(a,b,c,d){if(d=d||{},!this.agent)throw new Error("missing superagent or any api compatible agent.");"delete"===a&&(a="del"),"del"===a&&(c=void 0);var e=this.agent[a];if(!e)throw new Error("Unsupported method ["+a+"]");var f=e(b,c);return this._setHeaders(f,this.config.headers),this._setOptions(f,this.config.options),this._setOptions(f,d.options),this._setHeaders(f,d.headers),this._setHeaders(f,this.headers),this.config.withCredentials&&f.withCredentials(),f},addHeader:function(a,b){this.headers=this.headers||{},this.headers[a]=b},removeHeader:function(a){this.headers&&this.headers[a]&&delete this.headers[a]},_setHeaders:function(a,b){for(var c in b)a.set(c,b[c])},_setOptions:function(a,b){for(var c in b)a[c](b[c])},register:function(a,b){this.middlewares||(this.middlewares=[]),this.middlewares.push({name:a,fn:b})},_applyMiddlewares:function(a,b){if(!this.middlewares)return function(){};var c=[],d=function(){return new Promise(function(a,b){c.push([a,b])})};return this.middlewares.filter(function(a){return!b.use||b.use&&!1!==b.use[a.name]}).forEach(function(c,e){c.fn(a,d,b)},this),function(a,b){c.reverse().forEach(function(c){return a?c[1](a):c[0](b)})}}},a.default=b}),define("superapi",["./superapi/api","exports"],function(a,b){"use strict";function c(a){return new d(a)}var d=a.default;c.prototype.Api=d,b.default=c});